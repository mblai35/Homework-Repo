}
colIncrements
lastCol[1]
TemperatureGrid[1,]
dim(TemperatureGrid)
ZINB200 <- read.csv(file.choose())
View(ZINB200)
ZINB200 <- read.csv(file.choose())
View(ZINB200)
zinb <- c(ZINB$Correct.DE, ZINB200$Correct.DE)
lines(density(zinb))
lines(density(zinb), col = 'red')
zinb <- c(zinb, NB$Correct.DE)
lines(density(zinb), col = 'blue')
NB200 <- read.csv(file.choose())
zinb <- c(zinb, NB200$Correct.DE)
lines(density(zinb), col = 'green')
View(NB)
Xincrements
Lincrements
proc.time()
NB <- read.csv(file = "compcodebaySeqOUT.csv")
ZINB <- read.csv(file = "compcodebaySeqZINBout.csv")
ZINB200 <- read.csv(file.choose())
View(ZINB200)
NB200 <- read.csv(file.choose())
ZINB300 <- read.csv(file.choose())
View(ZINB300)
NB300 <- read.csv(file.choose())
View(NB200)
View(NB300)
View(ZINB)
View(ZINB200)
head(ZINB300)
NB200 <- NB200[, 2:8]
View(NB200)
ZINB200 <- ZINB200[, 2:8]
ZINB300 <- ZINB300[, 2:8]
NB300 <- NB300[, 2:8]
totalNB <- c(NB, NB200, NB300)
totalNB <- matrix(NB, NB200, NB300)
totalNB <- rbind(NB, NB200, NB300)
View(totalNB)
totalZINB <- rbind(ZINB, ZINB200, ZINB300)
plot(density(totalNB))
plot(density(totalNB$Correct.DE))
lines(density(totalZINB$Correct.DE))
plot(density(totalZINB$Correct.DE))
lines(density(totalNB$Correct.DE))
lines(density(totalNB$Correct.DE), col = 'blue')
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
xmode <- getmode(totalNB)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
View(a)
xmode <- getmode(totalNB$Correct.DE)
xmode
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(x, dbeta(x, shape1 = a, shape2 = b), col = 'red')
NBZINB <- rbind(totalNB, totalZINB)
plot(density(NBZINB$Correct.DE))
lines(x, dbeta(x, shape1 = a, shape2 = b), col = 'red')
xmode <- getmode(NBZINB$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), col = 'red')
abline(v=xmode)
33/9
4*50
200/60
.5*5
NB450 <- read.csv(file.choose())
NB <- read.csv(file.choose())
View(NB)
plot(density(NB$Correct.DE, width = .01), ylab = 'PDF', xlab = 'x', main = '', type = 'n')
lines(density(NB$Correct.DE, width = .01), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .03), ylab = 'PDF', xlab = 'x', main = '')
plot(density(NB$Correct.DE))
rm(NB200)
rm(NB300)
rm(ZINB200)
rm(ZINB300)
rm(totalNB)
rm(totalZINB)
rm(TemperatureGrid)
rm(colIncrements)
ZINB <- read.csv(file.choose())
NB <- read.csv(file.choose())
View(NB)
View(ZINB)
lines(density(NB$Correct.DE, width = .008), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .01), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .1), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .05), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .045), ylab = 'PDF', xlab = 'x', main = '')
plot(density(NB$Correct.DE))
lines(density(NB$Correct.DE, width = .04), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .03), ylab = 'PDF', xlab = 'x', main = '')
plot(density(NB$Correct.DE))
lines(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '')
lines(density(ZINB$Correct.DE, width = .03), ylab = 'PDF', xlab = 'Correctly Identified Genes', main = '')
plot(density(ZINB$Correct.DE))
lines(density(ZINB$Correct.DE, width = .03), ylab = 'PDF', xlab = 'Correctly Identified Genes', main = '')
lines(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Correctly Identified Genes', main = '')
plot(density(NB$Correct.DE, width = .01), ylab = 'PDF', xlab = 'x', main = '', type = 'n')
lines(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '')
lines(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Correctly Identified Genes', main = '')
lines(density(NB$Correct.DE, width = .05), ylab = 'PDF', xlab = 'x', main = '')
lines(density(NB$Correct.DE, width = .01), ylab = 'PDF', xlab = 'x', main = '')
plot(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '', type = 'n')
lines(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '')
lines(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Correctly Identified Genes', main = '')
plot(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '', type = 'n')
lines(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '')
lines(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Correctly Identified Genes', main = '')
lines(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'x', main = '', col = 'blue')
lines(density(ZINB$Correct.DE, width = .035),  main = '')
lines(density(ZINB$Correct.DE, width = .035),  main = '', col = 'red')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
plot(density(ZINB$Correct.DE))
?density
plot(density(NB$Correct.DE, width = .035), ylab = $f_{\delta}$, xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
plot(density(NB$Correct.DE, width = .035), ylab = '$f_{\delta}$', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
plot(density(NB$Correct.DE, width = .035), ylab = '$f_{\delta}$',
xlab = 'Proportion Correct', main = 'Correctly Identified Genes', type = 'n')
plot(density(NB$Correct.DE, width = .035), ylab = '',
xlab = 'Proportion Correct', main = 'Correctly Identified Genes', type = 'n')
plot(density(NB$Correct.DE, width = .035), ylab = 'f\delta',
xlab = 'Proportion Correct', main = 'Correctly Identified Genes', type = 'n')
plot(density(NB$Correct.DE, width = .035), ylab = 'PDF',
xlab = 'Proportion Correct', main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
legend('topleft', c('NB', 'ZINB'))
legend('topleft', c('NB', 'ZINB'), lty = c(1,2))
lines(density(NB$Correct.DE, width = .035), prob =T)
getwd()
getwd()
ZINB <- read.csv(file = 'compcodeRbaySeqZINB')
ZINB <- read.csv(file = 'compcodeRbaySeqZINB')
NB <- read.csv(file = 'compcodeRbaySeqNB')
getwd()
mean(ZINB$Correct.DE)
mean(NB$Correct.DE)
var(ZINB$Correct.DE)
var(NB$Correct.DE)
kurtosis(ZINB$Correct.DE)
total <- matrix(c(NB, ZINB))
View(total)
total <- c(NB, ZINB)
total <- rbind(NB, ZINB)
View(total)
lines(density(total$Correct.DE, width = .035), col = red)
lines(density(total$Correct.DE, width = .035), col = 'red')
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
a/(a+b)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
plot(density(total$Correct.DE), col = 'red')
plot(density(total$Correct.DE, width = .035), col = 'red')
plot(density(total$Correct.DE), col = 'red')
lines(density(total$Correct.DE, width = .035), col = 'red')
plot(density(total$Correct.DE, width = .035), col = 'red')
lines(x, dbeta(x, shape1 = a, shape2 = b))
statistics <- matrix(mean(ZINB$Correct.DE), mean(NB$Correct.DE), var(ZINB$Correct.DE), var(NB$Correct.DE), nrow = 2)
statistics <- matrix(c(mean(ZINB$Correct.DE), mean(NB$Correct.DE), var(ZINB$Correct.DE), var(NB$Correct.DE)), nrow = 2)
```
statistics
rownames(statistics) <- c('NB', 'ZINB')
statistics <- matrix(c(mean(ZINB$Correct.DE), mean(NB$Correct.DE), var(ZINB$Correct.DE), var(NB$Correct.DE)), nrow = 2, byrow = T)
statistics
rownames(statistics) <- c('mean', 'variance')
# Name the columns 'NB' and 'ZINB'.
colnames(statistics) <- c('NB', 'ZINB')
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
xmode <- getmode(total$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
lines(x, dbeta(x, shape1 = a, shape2 = b), col = 'red')
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
plot(density(total$Correct.DE, width = .035), col = 'red')
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
abline(v=xbar)
plot(density(total$Correct.DE, width = .035), col = 'red')
# Find alpha and beta for Beta distribution from mean and variance.
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
ZINB <- read.csv(file.choose())
plot(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
legend('topleft', c('NB', 'ZINB'), lty = c(1,2))
# Calculate statistics for each prior.
# mean
mean(ZINB$Correct.DE)
mean(NB$Correct.DE)
# variance
var(ZINB$Correct.DE)
var(NB$Correct.DE)
# Merge NB and ZINB data.
total <- rbind(NB, ZINB)
# Plot filtered PDF for combined NB and ZINB data.
plot(density(total$Correct.DE, width = .035), col = 'red')
# Find alpha and beta for Beta distribution from mean and variance.
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
xmode <- getmode(total$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
abline(v=xbar)
5000/50
NB <- read.csv(file.choose())
ZINB <- read.csv(file.choose())
plot(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
legend('topleft', c('NB', 'ZINB'), lty = c(1,2))
# Calculate statistics for each prior.
# mean
mean(ZINB$Correct.DE)
mean(NB$Correct.DE)
# variance
var(ZINB$Correct.DE)
var(NB$Correct.DE)
# Merge NB and ZINB data.
total <- rbind(NB, ZINB)
# Plot filtered PDF for combined NB and ZINB data.
plot(density(total$Correct.DE, width = .035), col = 'red')
# Find alpha and beta for Beta distribution from mean and variance.
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
plot(density(NB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
xmode <- getmode(NB$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
plot(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
legend('topleft', c('NB', 'ZINB'), lty = c(1,2))
# Calculate statistics for each prior.
# mean
mean(ZINB$Correct.DE)
mean(NB$Correct.DE)
# variance
var(ZINB$Correct.DE)
var(NB$Correct.DE)
# Merge NB and ZINB data.
total <- rbind(NB, ZINB)
lines(density(total$Correct.DE, width = .035), col = 'red')
plot(density(total$Correct.DE, width = .035), col = 'red')
NB <- read.csv(file.choose())
ZINB <- read.csv(file.choose())
# Create a filtered PDF with filter width of .035 for each prior.
plot(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
legend('topleft', c('NB', 'ZINB'), lty = c(1,2))
# Calculate statistics for each prior.
# mean
mean(ZINB$Correct.DE)
mean(NB$Correct.DE)
# variance
var(ZINB$Correct.DE)
var(NB$Correct.DE)
# Merge NB and ZINB data.
total <- rbind(NB, ZINB)
lines(density(total$Correct.DE, width = .035), col = 'red')
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
xmode <- getmode(total$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
abline(v=xbar)
abline(v=xmode)
plot(density(total$Correct.DE, width = .035), col = 'red')
lines(density(total$Correct.DE))
plot(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
legend('topleft', c('NB', 'ZINB'), lty = c(1,2))
mean(ZINB$Correct.DE)
mean(NB$Correct.DE)
# variance
var(ZINB$Correct.DE)
var(NB$Correct.DE)
total <- rbind(NB, ZINB)
lines(density(total$Correct.DE, width = .035), col = 'red')
# Plot filtered PDF for combined NB and ZINB data.
plot(density(total$Correct.DE, width = .035), col = 'red')
lines(density(total$Correct.DE))
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
plot(density(total$Correct.DE, width = .035), col = 'red')
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
xmode <- getmode(total$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
plot(density(total$Correct.TopCounts))
xbar<- mean(total$Correct.TopCounts)
xvar <- var(total$Correct.TopCounts)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(x, dbeta(x, shape1 = a, shape2 = b), col = 'red')
lines(x, dbeta(x, shape1 = a, shape2 = b), col = 'red', lty =2)
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(x, dbeta(x, shape1 = a, shape2 = b), col = 'red', lty =2)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty = 2)
plot(density(total$Correct.TopCounts))
lines(x, dbeta(x, shape1 = a, shape2 = b), lty = 2)
plot(density(total$Correct.TopCounts), ylab = "PDF", "True Positive Rate")
plot(density(total$Correct.TopCounts), ylab = "PDF", xlab = "Proportion", "True Positive Rate")
plot(density(NB$Correct.DE, width = .035), col = 'red')
xbar<- mean(NB$Correct.DE)
xvar <- var(NB$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
xmode <- getmode(NB$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
abline(v=xbar)
total <- rbind(NB, ZINB)
lines(density(total$Correct.DE, width = .035), col = 'red')
# Plot filtered PDF for combined NB and ZINB data.
plot(density(total$Correct.DE, width = .035), col = 'red')
# Find alpha and beta for Beta distribution from mean and variance.
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b))
x <- seq(0, 1, by = .001)
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n')
lines(x, dbeta(x, shape1 = a, shape2 = b))
plot(density(total$Correct.DE, width = .035), col = 'red')
x <- seq(0, 1, by = .001)
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n')
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(density(total$Correct.DE, width = .035), col = 'red')
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n', xlim = c(0, .6))
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(density(total$Correct.DE, width = .035), col = 'red')
# Find mode.
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
xmode <- getmode(total$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n', xlim = c(0, .6))
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(density(total$Correct.DE, width = .035), col = 'red')
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n')
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(density(total$Correct.DE, width = .035), col = 'red')
NB <- read.csv(file.choose())
ZINB <- read.csv(file.choose())
# Create a filtered PDF with filter width of .035 for each prior.
plot(density(ZINB$Correct.DE, width = .035), ylab = 'PDF', xlab = 'Proportion Correct',
main = 'Correctly Identified Genes', type = 'n')
lines(density(NB$Correct.DE, width = .035))
lines(density(ZINB$Correct.DE, width = .035), lty = 2)
legend('topleft', c('NB', 'ZINB'), lty = c(1,2))
# Calculate statistics for each prior.
# mean
mean(ZINB$Correct.DE)
mean(NB$Correct.DE)
# variance
var(ZINB$Correct.DE)
var(NB$Correct.DE)
# Merge NB and ZINB data.
total <- rbind(NB, ZINB)
lines(density(total$Correct.DE, width = .035), col = 'red')
# Find alpha and beta for Beta distribution from mean and variance.
xbar<- mean(total$Correct.DE)
xvar <- var(total$Correct.DE)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot filtered PDF for combined NB and ZINB data with Beta distribution.
x <- seq(0, 1, by = .001)
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n', xlim = c(0, .6))
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(density(total$Correct.DE, width = .035), col = 'red')
# Find mode.
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
xmode <- getmode(total$Correct.DE)
b <- (1 - xbar)*(((xbar*(1 - xbar))/xvar)-1)
a <- (xmode*b - 2*xmode + 1)/(1 - xmode)
#a <- xbar*(((xbar*(1-xbar))/xvar)-1)
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n')
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(density(total$Correct.DE, width = .035), col = 'red')
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
abline(v=xbar)
abline(v=xmode)
plot(x, dbeta(x, shape1 = a, shape2 = b), type = 'n')
lines(x, dbeta(x, shape1 = a, shape2 = b))
lines(density(total$Correct.DE, width = .035), col = 'red')
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty =2)
#abline(v=xbar)
abline(v=xmode)
plot(density(total$Correct.TopCounts), ylab = "PDF", xlab = "Proportion", "True Positive Rate")
xbar<- mean(total$Correct.TopCounts)
xvar <- var(total$Correct.TopCounts)
a <- xbar*(((xbar*(1-xbar))/xvar)-1)
b <- (1-xbar)*(((xbar*(1-xbar))/xvar)-1)
# Plot the Beta distribution with the appropriate alpha and beta.
x <- seq(0, 1, by = .001)
lines(x, dbeta(x, shape1 = a, shape2 = b), lty = 2)
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2)
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, xlim = c(.3,1))
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, xlim = c(.3,1), type = 'l')
lines(density(total$Correct.TopCounts), ylab = "PDF", xlab = "Proportion", "True Positive Rate")
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, xlim = c(.3,1), type = 'l',
ylab = "PDF", xlab = "Proportion", "True Positive Rate")
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, type = 'l',
ylab = "PDF", xlab = "Proportion", "True Positive Rate")
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, xlim = c(.3,1), type = 'l')
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, xlim = c(.3,1), type = 'l', ylab = "PDF")
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, xlim = c(.3,1), type = 'l',
ylab = "PDF", xlab = "Proportion", "True Positive Rate")
plot(x, dbeta(x, shape1 = a, shape2 = b), lty = 2, xlim = c(.3,1), type = 'l',
ylab = "PDF", xlab = "Proportion", main ="True Positive Rate")
lines(density(total$Correct.TopCounts))
